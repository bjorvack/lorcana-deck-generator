"use strict";(self.webpackChunklorcana_deck_generator=self.webpackChunklorcana_deck_generator||[]).push([[452],{947:(e,t,s)=>{s.d(t,{A:()=>c});const i=/Singer (\d+)/,n=/Resist \+(\d+) \(Damage dealt to this character is reduced by (\d+)\.\)/,r=/Challenger \+(\d+) \(While challenging, this character gets \+(\d) (?:\w+)?(?:{S})?\.\)/,a=/You may have up to\s+(\d+)\s+copies/i,o=/You may have any number of cards named/i,d=/You may only have\s+(\d+)\s+copies/i,l="crd_be70d689335140bdadcde5f5356e169d";class h{constructor(e){this.id=e.id,this.name=e.name,this.version=e.version||null,this.cost=e.cost||0,this.inkwell=e.inkwell||!1,this.ink=e.ink,this.inks=e.inks||[e.ink],this.keywords=e.keywords||[],this.types=e.type||[],this.classifications=e.classifications||[],this.text=e.text||"",this.image=e.image_uris?.digital?.large||e.image_uris?.digital?.normal||e.image_uris?.digital?.small||"",this.lore=e.lore||0,this.strength=e.strength||0,this.willpower=e.willpower||0,this.moveCost=e.move_cost||0,this.legality=e.legalities.core||"not_legal",this.requiredKeywords=[],this.requiredClassifications=[],this.requiredTypes=[],this.requiredCardNames=[],this.text=this.text.replace(/{[^}]+}/g,(e=>e.toLowerCase()));let t=this.text.split("\n");this.sanitizedText="";for(let e=0;e<t.length;e++){const s=t[e].split(" ")[0];this.keywords.includes(s)||(this.sanitizedText+=t[e]+"\n")}this.sanitizedText=this.sanitizedText.replace(/\([^)]+\)/g,""),this.sanitizedText=this.sanitizedText.replace(/\(|\)/g,""),this.sanitizedText=this.sanitizedText.trim().toLowerCase(),this.initialize()}initialize(){if(this.hasBodyguard=this.keywords.includes("Bodyguard"),this.hasReckless=this.keywords.includes("Reckless"),this.hasRush=this.keywords.includes("Rush"),this.hasWard=this.keywords.includes("Ward"),this.hasEvasive=this.keywords.includes("Evasive"),this.hasResist=this.keywords.includes("Resist"),this.hasChallenger=this.keywords.includes("Challenger"),this.hasSinger=this.keywords.includes("Singer"),this.hasShift=this.keywords.includes("Shift"),this.hasBoost=this.keywords.includes("Boost"),this.hasShift){let e=this.name.split("&").map((e=>e.trim()));this.requiredCardNames.push(...e)}}get title(){return this.name+(this.version?` - ${this.version}`:"")}get maxAmount(){if(o.test(this.text))return 99;const e=this.text.match(a);if(e)return parseInt(e[1]);const t=this.text.match(d);return t?parseInt(t[1]):4}get singCost(){if(this.hasSinger){const e=this.text.match(i);if(e)return parseInt(e[1])}return this.cost}get resistAmount(){if(this.hasResist){const e=this.text.match(n);if(e)return parseInt(e[1])}return 0}get challengerAmount(){if(this.hasChallenger){const e=this.text.match(r);if(e)return parseInt(e[1])}return 0}get boostAmount(){if(this.hasBoost){const e=/Boost \+(\d+) \(This character gets \+(\d+) (?:\w+)?(?:{S})?\.\)/,t=this.text.match(e);if(t)return parseInt(t[1])}return 0}deckMeetsRequirements(e){const t=e.filter((e=>e.id!==this.id));return this.deckMeetsRequiredKeywords(t)&&this.deckMeetsRequiredClassifications(t)&&this.deckMeetsRequiredTypes(t)&&this.deckMeetsRequiredCardNames(t)&&this.deckMeetsShiftRequirements(t)}hasRequirementsForDeck(e){const t=[],s=[],i=[],n=[];return e.forEach((e=>{t.push(...e.requiredKeywords),s.push(...e.requiredClassifications),i.push(...e.requiredTypes),n.push(...e.requiredCardNames)})),t.some((e=>this.keywords.includes(e)))||s.some((e=>this.classifications.includes(e)))||i.some((e=>this.types.includes(e)))||n.some((e=>this.name.includes(e)))}deckMeetsRequiredKeywords(e){if(0===this.requiredKeywords.length)return!0;const t=e.map((e=>e.keywords)).flat();return this.requiredKeywords.every((e=>t.includes(e)))}deckMeetsRequiredClassifications(e){if(0===this.requiredClassifications.length)return!0;const t=e.map((e=>e.classifications)).flat();return this.requiredClassifications.some((e=>t.includes(e)))}deckMeetsRequiredTypes(e){if(0===this.requiredTypes.length)return!0;const t=e.map((e=>e.types)).flat();return this.requiredTypes.every((e=>t.includes(e)))}deckMeetsRequiredCardNames(e){if(0===this.requiredCardNames.length)return!0;const t=e.map((e=>e.name));return this.requiredCardNames.some((e=>t.includes(e)))}deckMeetsShiftRequirements(e){if(!this.canShift)return!0;if(e.filter((e=>e.id===l)).length>0)return!0;const t=this.name.split("&").map((e=>e.trim())),s=e.filter((e=>t.includes(e.name)&&e.id!==this.id));let i=!1;return s.forEach((e=>{e.cost<this.cost&&(i=!0)})),i}canShiftFrom(e){if(!this.hasShift)return console.log(`Card ${this.title} can't shift`),!1;if(e.id===l)return!0;const t=this.name.split("&").map((e=>e.trim())),s=e.name.split("&").map((e=>e.trim()));return t.some((e=>s.includes(e)))}}class c{async getCards(){const e=[],t=[0,1,2,3,4,5,6,7,8,9,10].map((e=>this.getCardsByCost(e)));return(await Promise.all(t)).forEach((t=>e.push(...t))),e}async getCardsByCost(e){return fetch(`https://api.lorcast.com/v0/cards/search?q=cost:${e}`).then((e=>e.json())).then((e=>e.results)).then((e=>e.map((e=>new h(e)))))}}},844:(e,t,s)=>{s.d(t,{A:()=>i});class i{constructor(){this.dialog=document.querySelector('dialog[data-role="card-preview"]'),this.dialog||this._createDialog(),this._bindEvents()}_createDialog(){this.dialog=document.createElement("dialog"),this.dialog.dataset.role="card-preview";const e=document.createElement("button");e.dataset.role="close",e.innerHTML="&times;";const t=document.createElement("img");t.alt="Card Preview",this.dialog.appendChild(e),this.dialog.appendChild(t),document.body.appendChild(this.dialog)}_bindEvents(){const e=this.dialog.querySelector('[data-role="close"]');e&&e.addEventListener("click",(()=>this.hide())),this.dialog.addEventListener("click",(e=>{e.target===this.dialog&&this.hide()}))}show(e,t){const s=this.dialog.querySelector("img");s&&(s.src=e,s.alt=t||"Card Preview"),this.dialog.showModal()}hide(){this.dialog.close()}}},795:(e,t,s)=>{s.d(t,{A:()=>i});class i{constructor(e,t,s,i={}){this.cards=e,this.dialog=t,this.onCardSelected=s,this.options={filter:i.filter||(()=>!0),sort:i.sort||null,renderButtonText:i.renderButtonText||(()=>"Add Card"),...i},this.cardList=this.dialog.querySelector("[data-role=card-list]"),this.filterInput=this.dialog.querySelector("[data-role=filter]"),this.closeBtn=this.dialog.querySelector("[data-role=close]"),this.init()}init(){this.bindEvents()}bindEvents(){this.closeBtn.addEventListener("click",(()=>this.hide())),this.filterInput.addEventListener("input",(()=>{this.renderList(this.filterInput.value)})),this.cardList.addEventListener("click",(e=>{const t=e.target.closest("[data-role=add-card-to-deck]");if(t){const e=t.dataset.card,s=this.cards.find((t=>t.id===e));s&&this.onCardSelected(s)}}))}show(){this.dialog.showModal(),this.refresh(),this.filterInput.value="",this.filterInput.focus()}hide(){this.dialog.close()}refresh(){this.renderList(this.filterInput.value)}renderList(e){const t=e.toLowerCase();let s=this.cards.filter(this.options.filter);t&&(s=s.filter((e=>(e.title||e.name).toLowerCase().includes(t)||e.keywords&&e.keywords.join(" ").toLowerCase().includes(t)||e.types&&e.types.join(" ").toLowerCase().includes(t)||e.text&&e.text.toLowerCase().includes(t)))),this.options.sort&&s.sort(this.options.sort),this.cardList.innerHTML="",s.forEach((e=>{const t=document.createElement("div");t.dataset.role="card-container";const s=document.createElement("img");s.src=e.image,s.alt=e.title||e.name,s.dataset.role="card",t.appendChild(s);const i=document.createElement("button"),n=this.options.renderButtonText(e);i.innerHTML=n,i.dataset.role="add-card-to-deck",i.dataset.card=e.id,n.includes("Max Reached")&&(i.disabled=!0,i.classList.add("opacity-50","cursor-not-allowed")),t.appendChild(i),this.cardList.appendChild(t)}))}}},238:(e,t,s)=>{s.d(t,{A:()=>a});var i=s(868),n=s(100),r=s.n(n);class a{constructor(e){this.canvas=e}renderChart(e){void 0!==this.canvas.chart&&this.canvas.chart.destroy(),this.canvas.parentElement.classList.remove("hidden");const t=[],s=[...new Set(e.map((e=>e.ink)))].sort(),n={Amber:"#FFC107",Amethyst:"#9C27B0",Emerald:"#4CAF50",Ruby:"#F44336",Sapphire:"#2196F3",Steel:"#607D8B"};for(const i of s){const s=e.filter((e=>e.ink===i||e.inks?.includes(i))),a=Array.from({length:11},(()=>0)),o=Array.from({length:11},(()=>0));for(const e of s)e.inkwell?a[e.cost]++:o[e.cost]++;t.push({label:i,data:a,backgroundColor:n[i]}),t.push({label:`${i} (Non-Inkable)`,data:o,backgroundColor:r().draw("diagonal",n[i])})}this.canvas.chart=new i.t1(this.canvas,{type:"bar",data:{labels:[0,1,2,3,4,5,6,7,8,9,10],datasets:t},options:{scales:{x:{stacked:!0},y:{stacked:!0}}}})}}},814:(e,t,s)=>{s.d(t,{A:()=>i});class i{constructor(e,t={}){this.container=e,this.onRemove=t.onRemove||null,this.onAdd=t.onAdd||null,this.onCardClick=t.onCardClick||null,this.isEditable=void 0===t.isEditable||t.isEditable,this.showAddPlaceholder=void 0!==t.showAddPlaceholder&&t.showAddPlaceholder;const{onRemove:s,onAdd:i,onCardClick:n,isEditable:r,showAddPlaceholder:a,...o}=t;this.options=o}render(e,t=[]){if(this.container.innerHTML="",this._sortDeck(e,t).forEach((e=>{const t=this._createCardElement(e);this.container.appendChild(t)})),this.showAddPlaceholder&&e.length<60){const e=this._createAddPlaceholder();this.container.appendChild(e)}}_sortDeck(e,t){return[...e].sort(((e,s)=>{if(e.ink!==s.ink)return t.length>0?t.indexOf(e.ink)-t.indexOf(s.ink):(e.ink||"").localeCompare(s.ink||"");const i=["Character","Action","Item","Location"],n=e.types&&e.types.length>0?e.types[0]:"",r=s.types&&s.types.length>0?s.types[0]:"";return n!==r?i.indexOf(n)-i.indexOf(r):e.cost!==s.cost?e.cost-s.cost:(e.title||e.name).localeCompare(s.title||s.name)}))}_createCardElement(e){const t=document.createElement("div");t.dataset.role="card-container";const s=document.createElement("img");if(s.src=e.image,s.alt=e.title||e.name,s.dataset.role="card",s.dataset.cardId=e.id,this.onCardClick&&(s.style.cursor="pointer",s.addEventListener("click",(()=>this.onCardClick(e)))),t.appendChild(s),this.isEditable){const s=document.createElement("button");s.textContent="X",s.dataset.role="remove-card",s.dataset.cardId=e.id,s.addEventListener("click",(t=>{t.stopPropagation(),this.onRemove&&this.onRemove(e.id)})),t.appendChild(s)}return t}_createAddPlaceholder(){const e=document.createElement("div");e.dataset.role="card-container";const t=document.createElement("button");return t.textContent="Add card",t.dataset.role="add-card",t.addEventListener("click",(e=>{e.stopPropagation(),this.onAdd&&this.onAdd()})),e.appendChild(t),e}}},479:(e,t,s)=>{s.d(t,{A:()=>i});class i{constructor(e,t={}){this.container=e,this.options={onChange:t.onChange||(()=>{}),defaultInks:t.defaultInks||[],...t},this.inks=["Amber","Amethyst","Emerald","Ruby","Sapphire","Steel"],this.render()}render(){this.container.innerHTML=`\n            <div class="inks mb-1">\n                <div class="form-group">\n                    <label for="primaryInk">Primary Ink</label>\n                    <select name="primaryInk" data-role="primary-ink">\n                        <option value="Random" selected>Random Ink</option>\n                        ${this.inks.map((e=>`<option value="${e}">${e}</option>`)).join("")}\n                    </select>\n                </div>\n                <div class="form-group">\n                    <label for="secondaryInk">Secondary Ink</label>\n                    <select name="secondaryInk" data-role="secondary-ink">\n                        <option value="Random" selected>Random Ink</option>\n                        ${this.inks.map((e=>`<option value="${e}">${e}</option>`)).join("")}\n                    </select>\n                </div>\n            </div>\n        `,this.primarySelect=this.container.querySelector('[data-role="primary-ink"]'),this.secondarySelect=this.container.querySelector('[data-role="secondary-ink"]'),this.primarySelect.addEventListener("change",(()=>this._handleInkChange())),this.secondarySelect.addEventListener("change",(()=>this._handleInkChange())),2===this.options.defaultInks.length&&(this._setInk(this.primarySelect,this.options.defaultInks[0]),this._setInk(this.secondarySelect,this.options.defaultInks[1])),this._handleInkChange()}_setInk(e,t){const s=Array.from(e.options).find((e=>e.value===t));s&&(s.selected=!0)}_handleInkChange(){let e=this.primarySelect.value,t=this.secondarySelect.value,s=!1;if("Random"===e){const t=this.inks[Math.floor(Math.random()*this.inks.length)];this._setInk(this.primarySelect,t),e=t,s=!0}if("Random"===t){const e=this.inks[Math.floor(Math.random()*this.inks.length)];this._setInk(this.secondarySelect,e),t=e,s=!0}const i=[e,t].sort();this.options.onChange(i)}getSelectedInks(){return[this.primarySelect.value,this.secondarySelect.value].sort()}}}}]);